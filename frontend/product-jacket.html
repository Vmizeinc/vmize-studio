<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sherpa Hooded Jacket - VMIZE Studio</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --vmize-purple: #6B4CE6;
            --vmize-blue: #4CC9F0;
            --text-primary: #1a1a1a;
            --text-secondary: #666;
            --border-color: #e0e0e0;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            color: var(--text-primary);
            line-height: 1.6;
            background: #f8f9fa;
        }
        header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding: 16px 32px;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo { display: flex; align-items: center; text-decoration: none; }
        nav { display: flex; gap: 32px; align-items: center; }
        nav a {
            text-decoration: none;
            color: var(--text-primary);
            font-weight: 600;
            transition: color 0.3s;
        }
        nav a:hover { color: var(--vmize-purple); }
        .back-btn {
            padding: 10px 20px;
            background: white;
            color: var(--vmize-purple);
            border: 2px solid var(--vmize-purple);
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            border: none;
        }
        .back-btn:hover {
            background: #f5f3ff;
            transform: translateX(-4px);
        }
        .product-container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 60px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .product-images { display: flex; flex-direction: column; gap: 20px; }
        .main-image {
            width: 100%;
            border-radius: 12px;
            overflow: hidden;
            background: #f8f9fa;
        }
        .main-image img {
            width: 100%;
            height: auto;
            display: block;
        }
        .product-info { display: flex; flex-direction: column; }
        .product-brand {
            font-size: 14px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        .product-title {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 16px;
        }
        .product-price {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--vmize-purple), var(--vmize-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 24px;
        }
        .product-description {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.8;
        }
        .product-features {
            margin-bottom: 32px;
        }
        .product-features h3 {
            font-size: 18px;
            margin-bottom: 12px;
        }
        .product-features ul {
            list-style: none;
            padding: 0;
        }
        .product-features li {
            padding: 8px 0;
            color: var(--text-secondary);
        }
        .product-features li:before {
            content: "‚úì ";
            color: var(--vmize-purple);
            font-weight: bold;
            margin-right: 8px;
        }
        .size-selector {
            margin-bottom: 32px;
        }
        .size-selector h3 {
            font-size: 16px;
            margin-bottom: 12px;
        }
        .size-options {
            display: flex;
            gap: 12px;
        }
        .size-option {
            padding: 12px 20px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .size-option:hover { border-color: var(--vmize-purple); }
        .size-option.selected {
            border-color: var(--vmize-purple);
            background: #f5f3ff;
        }
        .product-actions {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        .btn {
            padding: 16px 32px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        .btn-primary {
            background: linear-gradient(135deg, var(--vmize-purple), var(--vmize-blue));
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(107, 76, 230, 0.3);
        }
        .btn-secondary {
            background: white;
            color: var(--vmize-purple);
            border: 2px solid var(--vmize-purple);
        }
        .btn-secondary:hover { background: #f5f3ff; }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        .modal.active { display: flex; }
        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 40px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
        }
        .modal-title {
            font-size: 24px;
            font-weight: 700;
        }
        .modal-close {
            background: none;
            border: none;
            font-size: 32px;
            cursor: pointer;
            color: var(--text-secondary);
        }
        .upload-section { margin-bottom: 32px; }
        .upload-label {
            display: block;
            font-weight: 600;
            margin-bottom: 12px;
        }
        .upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .upload-area:hover {
            border-color: var(--vmize-purple);
            background: #f5f3ff;
        }
        .upload-area.has-image {
            border-style: solid;
            border-color: var(--vmize-purple);
        }
        .preview-image {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            margin-top: 16px;
            display: none;
        }
        .result-section { margin-top: 32px; }
        .result-image {
            width: 100%;
            border-radius: 12px;
            margin-top: 16px;
        }
        .loading {
            text-align: center;
            padding: 40px;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--vmize-purple);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        footer {
            background: white;
            padding: 48px 32px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
        }
        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
        }
        .footer-grid {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr;
            gap: 48px;
            margin-bottom: 40px;
        }
        .footer-desc {
            color: var(--text-secondary);
            line-height: 1.6;
            max-width: 300px;
        }
        .footer-links h4 {
            margin-bottom: 16px;
            font-weight: 700;
            color: #000000;
        }
        .footer-links a {
            display: block;
            color: var(--text-secondary);
            text-decoration: none;
            margin-bottom: 12px;
            transition: color 0.3s;
        }
        .footer-links a:hover { color: var(--vmize-purple); }
        .footer-bottom {
            border-top: 1px solid var(--border-color);
            padding-top: 24px;
            text-align: center;
            color: #999;
            font-size: 14px;
        }
        @media (max-width: 900px) {
            nav { display: none; }
            .product-container {
                grid-template-columns: 1fr;
                padding: 32px 24px;
            }
            .footer-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <a href="index.html" class="logo">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 450 200" width="180" height="80">
                  <defs>
                    <linearGradient id="vGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                      <stop offset="0%" style="stop-color:#4CC9F0;stop-opacity:1" />
                      <stop offset="50%" style="stop-color:#6B4CE6;stop-opacity:1" />
                      <stop offset="100%" style="stop-color:#5a3dd5;stop-opacity:1" />
                    </linearGradient>
                  </defs>
                  <g transform="translate(30, 40)">
                    <polygon points="0,0 30,150 50,150 20,0" fill="url(#vGradient)" opacity="0.9"/>
                    <polygon points="40,0 70,150 90,150 60,0" fill="url(#vGradient)"/>
                    <line x1="15" y1="20" x2="35" y2="130" stroke="rgba(255,255,255,0.3)" stroke-width="3"/>
                  </g>
                  <text x="140" y="125" font-family="Arial, Helvetica, sans-serif" 
                        font-size="85" font-weight="bold" font-style="italic" fill="#1a1a1a">mize</text>
                  <text x="170" y="155" font-family="Arial, Helvetica, sans-serif" 
                        font-size="28" font-weight="normal" letter-spacing="6" fill="#7a7a7a">STUDIO</text>
                </svg>
            </a>
            <nav>
                <a href="index.html">Home</a>
                <a href="about.html">About</a>
                <a href="demo-public.html" class="active">Demo</a>
                <a href="integration-hub-complete.html">Integration</a>
                <a href="pricing.html">Pricing</a>
                <a href="login.html">Login</a>
            </nav>
            <button class="back-btn" onclick="goBack()">
                <span>‚Üê</span> Back
            </button>
        </div>
    </header>

    <div class="product-container">
        <div class="product-images">
            <div class="main-image">
                <img src="https://images.unsplash.com/photo-1591047139829-d91aecb6caea?w=800&h=1200&fit=crop" 
                     alt="Sherpa Hooded Jacket" 
                     id="productImage">
            </div>
        </div>

        <div class="product-info">
            <div class="product-brand">Outdoor</div>
            <h1 class="product-title">Sherpa Hooded Jacket</h1>
            <div class="product-price">$149.99</div>

            <div class="product-description">
                <p>Stay warm and stylish with our premium Sherpa Hooded Jacket. Featuring ultra-soft sherpa fleece lining and a durable weather-resistant outer shell, this jacket provides exceptional warmth without sacrificing style. The modern silhouette and neutral design make it perfect for any outdoor adventure or casual outing.</p>
                <p>Designed for versatility and comfort, this unisex jacket includes practical features like zippered pockets, adjustable hood, and ribbed cuffs. Whether you're hiking mountain trails or running errands in town, this jacket keeps you comfortable in any weather.</p>
            </div>

            <div class="product-features">
                <h3>Features</h3>
                <ul>
                    <li>Ultra-soft sherpa fleece lining</li>
                    <li>Weather-resistant outer shell</li>
                    <li>Adjustable drawstring hood</li>
                    <li>Multiple zippered pockets</li>
                    <li>Ribbed cuffs and hem for warmth</li>
                    <li>Unisex fit - works for everyone</li>
                </ul>
            </div>

            <div class="size-selector">
                <h3>Select Size</h3>
                <div class="size-options">
                    <div class="size-option" onclick="selectSize(this)">S</div>
                    <div class="size-option selected" onclick="selectSize(this)">M</div>
                    <div class="size-option" onclick="selectSize(this)">L</div>
                    <div class="size-option" onclick="selectSize(this)">XL</div>
                </div>
            </div>

            <div class="product-actions">
                <button class="btn btn-primary" onclick="openTryOnModal()">
                    üß• Try It On Virtually
                </button>
                <button class="btn btn-secondary">
                    Add to Cart
                </button>
            </div>
        </div>
    </div>

    <div class="modal" id="tryOnModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Virtual Try-On</h2>
                <button class="modal-close" onclick="closeTryOnModal()">&times;</button>
            </div>

            <div class="upload-section">
                <label class="upload-label">Upload Your Photo</label>
                <div class="upload-area" id="uploadArea" onclick="document.getElementById('photoInput').click()">
                    <p>Click to upload or drag and drop</p>
                    <p style="font-size: 14px; color: #999; margin-top: 8px;">JPG, PNG (max 5MB)</p>
                    <input type="file" id="photoInput" accept="image/*" style="display: none;" onchange="handlePhotoUpload(event)">
                    <img id="previewImage" class="preview-image">
                </div>
            </div>

            <button class="btn btn-primary" id="generateBtn" onclick="generateTryOn()" style="width: 100%; display: none;">
                Generate Virtual Try-On
            </button>

            <div id="loadingSection" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p>Generating your virtual try-on...</p>
                <p style="font-size: 14px; color: #999; margin-top: 8px;">This may take 10-15 seconds</p>
            </div>

            <div id="resultSection" class="result-section" style="display: none;">
                <h3>Your Virtual Try-On Result</h3>
                <img id="resultImage" class="result-image">
                <button class="btn btn-primary" onclick="resetTryOn()" style="width: 100%; margin-top: 16px;">
                    Try Another Photo
                </button>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-grid">
                <div>
                    <div class="footer-logo">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 450 200" width="180" height="80">
                          <defs>
                            <linearGradient id="vGrad2" x1="0%" y1="0%" x2="100%" y2="100%">
                              <stop offset="0%" style="stop-color:#4CC9F0;stop-opacity:1" />
                              <stop offset="50%" style="stop-color:#6B4CE6;stop-opacity:1" />
                              <stop offset="100%" style="stop-color:#5a3dd5;stop-opacity:1" />
                            </linearGradient>
                          </defs>
                          <g transform="translate(30, 40)">
                            <polygon points="0,0 30,150 50,150 20,0" fill="url(#vGrad2)" opacity="0.9"/>
                            <polygon points="40,0 70,150 90,150 60,0" fill="url(#vGrad2)"/>
                            <line x1="15" y1="20" x2="35" y2="130" stroke="rgba(255,255,255,0.3)" stroke-width="3"/>
                          </g>
                          <text x="140" y="125" font-family="Arial, Helvetica, sans-serif" 
                                font-size="85" font-weight="bold" font-style="italic" fill="#1a1a1a">mize</text>
                          <text x="170" y="155" font-family="Arial, Helvetica, sans-serif" 
                                font-size="28" font-weight="normal" letter-spacing="6" fill="#7a7a7a">STUDIO</text>
                        </svg>
                    </div>
                    <p class="footer-desc">
                        AI-powered virtual try-on technology that helps e-commerce brands increase conversion and reduce returns.
                    </p>
                </div>
                <div class="footer-links">
                    <h4>Product</h4>
                    <a href="index.html#features">Features</a>
                    <a href="demo-public.html">Try Demo</a>
                    <a href="register-final-pricing.html">Pricing</a>
                    <a href="integration-hub-complete.html">Integration</a>
                </div>
                <div class="footer-links">
                    <h4>Company</h4>
                    <a href="mailto:support@vmizestudio.com">Contact</a>
                    <a href="#">Contact</a>
                </div>
                <div class="footer-links">
                    <h4>Resources</h4>
                    <a href="documentation.html">Documentation</a>
                    <a href="api-reference.html">API Reference</a>
                    <a href="help-center.html">Help Center</a>
                </div>
                <div class="footer-links">
                    <h4>Legal</h4>
                    <a href="privacy.html">Privacy Policy</a>
                    <a href="terms.html">Terms of Service</a>
                    <a href="cookie-policy.html">Cookie Policy</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>¬© 2025 VMIZE Studio. All rights reserved. Based in San Jose, California.</p>
            </div>
        </div>
    </footer>

    <script>
        const BACKEND_URL = 'http://localhost:50277';
        const DEMO_API_KEY = 'vmize_pk_demo_test_1234567890';
        let uploadedPhoto = null;

        function goBack() {
            window.location.href = 'demo-public.html';
        }

        function selectSize(element) {
            document.querySelectorAll('.size-option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
        }

        function openTryOnModal() {
            document.getElementById('tryOnModal').classList.add('active');
        }

        function closeTryOnModal() {
            document.getElementById('tryOnModal').classList.remove('active');
            resetTryOn();
        }

        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                if (file.size > 5 * 1024 * 1024) {
                    alert('File size must be less than 5MB');
                    return;
                }
                const reader = new FileReader();
                reader.onload = function(e) {
                    uploadedPhoto = e.target.result;
                    document.getElementById('previewImage').src = e.target.result;
                    document.getElementById('previewImage').style.display = 'block';
                    document.getElementById('uploadArea').classList.add('has-image');
                    document.getElementById('generateBtn').style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        }

        async function generateTryOn() {
            if (!uploadedPhoto) {
                alert('Please upload a photo first');
                return;
            }

            document.getElementById('generateBtn').style.display = 'none';
            document.getElementById('loadingSection').style.display = 'block';

            try {
                const productImage = document.getElementById('productImage').src;

                const response = await fetch(`${BACKEND_URL}/api/tryon/generate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-api-key': DEMO_API_KEY
                    },
                    body: JSON.stringify({
                        model_image: uploadedPhoto,
                        garment_image: productImage,
                        category: 'tops'
                    })
                });

                if (!response.ok) {
                    throw new Error('Failed to generate try-on');
                }

                const data = await response.json();
                const predictionId = data.prediction_id;

                await pollForResult(predictionId);

            } catch (error) {
                console.error('Error:', error);
                alert('Failed to generate try-on. Please try again.');
                document.getElementById('loadingSection').style.display = 'none';
                document.getElementById('generateBtn').style.display = 'block';
            }
        }

        async function pollForResult(predictionId) {
            const maxAttempts = 30;
            let attempts = 0;

            const checkStatus = async () => {
                try {
                    const response = await fetch(`${BACKEND_URL}/api/tryon/${predictionId}`, {
                        headers: {
                            'x-api-key': DEMO_API_KEY
                        }
                    });

                    if (!response.ok) {
                        throw new Error('Failed to check status');
                    }

                    const data = await response.json();

                    if (data.status === 'completed') {
                        document.getElementById('loadingSection').style.display = 'none';
                        document.getElementById('resultSection').style.display = 'block';
                        document.getElementById('resultImage').src = data.output.image_url;
                    } else if (data.status === 'failed') {
                        throw new Error('Try-on generation failed');
                    } else {
                        attempts++;
                        if (attempts < maxAttempts) {
                            setTimeout(checkStatus, 2000);
                        } else {
                            throw new Error('Request timeout');
                        }
                    }
                } catch (error) {
                    console.error('Polling error:', error);
                    alert('Failed to get result. Please try again.');
                    document.getElementById('loadingSection').style.display = 'none';
                    document.getElementById('generateBtn').style.display = 'block';
                }
            };

            checkStatus();
        }

        function resetTryOn() {
            uploadedPhoto = null;
            document.getElementById('previewImage').style.display = 'none';
            document.getElementById('previewImage').src = '';
            document.getElementById('uploadArea').classList.remove('has-image');
            document.getElementById('generateBtn').style.display = 'none';
            document.getElementById('loadingSection').style.display = 'none';
            document.getElementById('resultSection').style.display = 'none';
            document.getElementById('photoInput').value = '';
        }

        window.addEventListener('load', () => {
            const events = JSON.parse(localStorage.getItem('vmize_events') || '[]');
            events.push({
                event: 'product_view',
                properties: { 
                    product: 'Sherpa Hooded Jacket',
                    price: 149.99,
                    category: 'tops'
                },
                timestamp: new Date().toISOString(),
                visitor_id: localStorage.getItem('vmize_visitor_id') || 'visitor_' + Date.now()
            });
            if (events.length > 100) events.shift();
            localStorage.setItem('vmize_events', JSON.stringify(events));
        });
    </script>
</body>
</html>